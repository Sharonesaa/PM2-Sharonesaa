<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/formulario.css">


    <title>Agregar Película</title>
</head>
<body>
    <div class="container">
        <title>Agregar Película</title>
    </head>
    <body>
        <div class="container">
            <h1>Agregar Película</h1>
            <form id="movieForm">
                <label for="title">Título:</label>
                <input type="text" id="title" name="title" required>
    
                <label for="overview">Resumen:</label>
                <textarea id="overview" name="overview" required></textarea>
    
                <label for="poster">URL del Póster:</label>
                <input type="text" id="poster" name="poster" required>
    
                <label for="genres">Genero:</label>
                <input type="text" id="genres" name="genres" required>
    
                <label for="backdrop">URL del Fondo:</label>
                <input type="text" id="backdrop" name="backdrop" required>

                <label for="director">Director:</label>
                <input type="text" id="director" name="director" required>
    
                <label for="year">Año:</label>
                <input type="text" id="year" name="year" required>
    
                <label for="duration">Duración:</label>
                <input type="text" id="duration" name="duration" required>

                <label for="rate">Puntuación:</label>
                <input type="text" id="rate" name="rate" required>
    
                <button type="submit">Agregar</button>
                <button type="button" class="button-secondary" onclick="closeIframe()">Cerrar</button>
            </form>
        </div>
    
        <script>
            document.getElementById('movieForm').addEventListener('submit', async function(event) {
                event.preventDefault();
                const formData = new FormData(document.getElementById('movieForm'));
                
                // Crear un objeto para almacenar los datos del formulario
                const formDataObject = {};
                for (const [key, value] of formData.entries()) {
                    formDataObject[key] = value;
                }
    
                console.log('Datos del formulario a enviar:', formDataObject);
    
                try {
                    const response = await fetch('http://localhost:3000/movies', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json', // Indica que el cuerpo de la solicitud está en formato JSON
                        },
                        body: JSON.stringify(formDataObject), // Convierte el objeto de datos del formulario a JSON antes de enviarlo
                    });
                    const data = await response.json();
                    alert('Película agregada correctamente');
                    console.log(data); // Puedes hacer algo con la respuesta del servidor si lo deseas
                } catch (error) {
                    console.error('Error al agregar película:', error);
                    alert('Error al agregar película');
                }
            });
    
            function closeIframe() {
                parent.document.getElementById('addMovieForm').style.display = 'none';
            }
        </script>
</body>
</html>